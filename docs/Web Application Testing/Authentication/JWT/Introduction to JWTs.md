https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/

JWT is composed of three parts
- header
	- `{'alg': 'HS256', 'typ': 'JWT'}`
	- HMAC-SHA256
- payload
	- `{'loggedInAs': 'admin', 'iat':1091830921}`
	- iat = issued at
- signature
	- Uses algorithm specified in header, a secret key specified by the application, and unsigned token to create a signature

```javascript
header = '{"alg":"HS256","typ":"JWT"}'
payload = '{"loggedInAs":"admin","iat":1422779638}'
key = 'secretkey'
unsignedToken = encodeBase64(header) + '.' + encodeBase64(payload)
signature = HMAC-SHA256(key, unsignedToken)
token = encodeBase64(header) + '.' + encodeBase64(payload) + '.' + encodeBase64(signature)
// Result: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6InVzZXIiLCJpYXQiOiIxNjUxNTM4ODI5In0.NTEyYTI3YzZhZWVmMDI1ZDNhZWI4ZjdlZGE2ODI0NzE3YzVhZWZlMzI1NjZiYjgxZDYzYTM2MWY2YWU2ODcwZgeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyHI
```
## Attack Vectors
- [[pentesting/docs/Web Application Testing/Authentication/JWT/Attack Vectors/'none' signature attack|'none' signature attack]]
- [[pentesting/docs/Web Application Testing/Authentication/JWT/Attack Vectors/Bruteforcing JWT Secret|Bruteforcing JWT Secret]]
- [[pentesting/docs/Web Application Testing/Authentication/JWT/Attack Vectors/Directory Traversal in 'kid' parameter|Directory Traversal in 'kid' parameter]]
- [[pentesting/docs/Web Application Testing/Authentication/JWT/Attack Vectors/Signature confusion|Signature confusion]]